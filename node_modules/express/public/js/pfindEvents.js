var ref = new Firebase("https://toitle.firebaseio.com/events");
   //$(function() {
  //   alert("get flags");
   //    ref.once("value", function(snapshot) {
  // The callback function will get called twice, once for "fred" and once for "barney"
  //      snapshot.forEach(function(childSnapshot) {
  //        event = childSnapshot;
  //        eventAdress = event.child('event_address');
          //alert(""+childSnapshot.key()+eventAdress.val());
  //        alert("huh? "+points.length);
  //        points.push(eventAdress.val());
  //      });
  //    });
  //    return;
  //   });


  var lat = 38.987103;
  var lon = -76.942542;
  if(navigator.geolocation){
    navigator.geolocation.getCurrentPosition( function(location){
      lat = location.coords.latitude;
      lon = location.coords.longitude;
    });
  }else{
    lat = 38.987103;
    lon = -76.942542;
  }
  
  var myCenter=new google.maps.LatLng(lat,lon);
  function initialize()
  {
   var mapProp = {
    center:myCenter,
    zoom:15,
    mapTypeId:google.maps.MapTypeId.ROADMAP
  };
  var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);

  ref.once("value", function(snapshot) {
  // The callback function will get called twice, once for "fred" and once for "barney"
  snapshot.forEach(function(childSnapshot) {
    event = childSnapshot;
    eventAdress = event.child('event_address');
    eventAdress = eventAdress.val()
    if(eventAdress.geolocation){
      eventAdress.geolocation.getCurrentPosition( function(location){
        lat = location.coords.latitude;
        lon = location.coords.longitude;
      });
    }else{
      lat = 38.987103;
      lon = -76.942542;
    }
    var myCenter=new google.maps.LatLng(lat,lon);
    var marker=new google.maps.Marker({
      position:myCenter,
    });
    marker.setMap(map);
  });
});
  
}

google.maps.event.addDomListener(window, 'load', initialize);